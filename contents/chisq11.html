<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.8.0/p5.js"></script>
    <script src="oldjs/randomVariableNew.js"></script>
    <link rel="stylesheet" href="css/contents_style.css">
    <title>カイ二乗分布を作る (1)</title>
  </head>

  <body>
    <div class="description">
      <h2>カイ二乗分布を作る (2) version 0.1</h2>
    <div id="theory">
      <p>標準正規分布にしたがう、互いに独立な確率変数\(Z\)があるとき、それらの2乗を\(k\)個足し合わせた、新しい確率変数\(W=\sum_{i=1}^k Z^2_i\)は、自由度\(k\)のカイ二乗分布にしたがいます。期待値は\(E[W] = k\)、分散は\(V[W] = 2k\)です。<br />
      ここでは、指定した自由度のカイ二乗分布を、標準正規分布にしたがう確率変数の2乗（\(Z^2\)）の総和を求めることによってシミュレートします。</p>
    </div><p>自由度、サンプリングサイズを指定して、<span class="button">Start</span>ボタンを押してください。<br />
      指定された自由度の数だけ、標準正規分布にしたがう確率変数の2乗をプロットし、最下段にそれらの和をプロットします。サンプリングが終わるとヒストグラムを描きます。実行時間は、サンプリングサイズ1000で約70秒です。
      </p>
      <p>
        自由度 =<input id="df" type="number" step="1" value="2" min="2" max="10"></input> &nbsp;&nbsp;
        サンプリングサイズ =<input id="sample_size" type="number" step="500" value="1000" min="1000" max="3000"></input> &nbsp;&nbsp;
        <input id="btn_start" type="button" value="Start" />
        <input id="btn_stop" type="button" value="Stop" hidden />
      </p>
    </div>
    <div id="p5">
      <script src="scripts/chisq11.js" type="text/javascript"></script>
    </div>
    <div id="result"></div>
  </body>
</html>
